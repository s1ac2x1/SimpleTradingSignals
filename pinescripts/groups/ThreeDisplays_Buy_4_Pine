//@version=5
indicator("Three Displays Type 4 Indicator")

weeklyEMA26 = request.security(syminfo.tickerid, "W", ta.ema(close, 26), lookahead=barmerge.lookahead_on)
dailyClose = request.security(syminfo.tickerid, 'D', close)

weeklyOpen = request.security(syminfo.tickerid, 'W', open, lookahead=barmerge.lookahead_on)
weeklyClose = request.security(syminfo.tickerid, 'W', close, lookahead=barmerge.lookahead_on)

screenOneLastQuoteGreen = weeklyOpen < weeklyClose

weeklyLow = request.security(syminfo.tickerid, 'W', low, lookahead=barmerge.lookahead_on)
weeklyHigh = request.security(syminfo.tickerid, 'W', high, lookahead=barmerge.lookahead_on)

weeklyLastQuoteHigher = weeklyLow > weeklyLow[1] and weeklyHigh > weeklyHigh[1]
weeklyLastQouteCrossesEMA26 = weeklyLow <= weeklyEMA26 and weeklyHigh >= weeklyEMA26

[weeklyMACD, weeklySignal, weeklyHistogram] = request.security(syminfo.tickerid, "1W", ta.macd(close, 12, 26, 9), lookahead=barmerge.lookahead_on)
weeklyLastHistogramGrows = weeklyHistogram > weeklyHistogram[1]

screenOneCheck = screenOneLastQuoteGreen and weeklyLastQuoteHigher and weeklyLastQouteCrossesEMA26 and weeklyLastHistogramGrows

// ======== screen two ========

dailyHigh = request.security(syminfo.tickerid, 'D', high)
dailyLastHighGrowing = dailyHigh > dailyHigh[1]

dailyEMA13 = request.security(syminfo.tickerid, "D", ta.ema(close, 13))
dailyLow = request.security(syminfo.tickerid, 'D', low)
dailyLastBarAboveEMA13 = dailyLow > dailyEMA13 and dailyHigh > dailyEMA13

[dailyMACD, dailySignal, dailyHistogram] = request.security(syminfo.tickerid, "D", ta.macd(close, 12, 26, 9))
dailyLastHistogramGrows = dailyHistogram > dailyHistogram[1]

dailyStochK = ta.stoch(close, high, low, 14)
dailyStochD = ta.sma(dailyStochK, 3)

dailyLastStochAscendingFastAndSlow = dailyStochK > dailyStochK[1] and dailyStochD > dailyStochD[1]

screenTwoCheck = dailyLastHighGrowing and (not dailyLastBarAboveEMA13) and dailyLastHistogramGrows and dailyLastStochAscendingFastAndSlow